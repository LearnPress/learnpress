const _=window._;window.$Vue=window.$Vue||window.Vue,jQuery(document).ready((function(e){const t=!!$Vue&&$Vue.http;document.getElementById("vue-modal-search-items")&&$Vue&&($Vue.component("learn-press-modal-search-items",{template:"#learn-press-modal-search-items",data:()=>({paged:1,term:"",hasItems:!1,selected:[]}),watch:{show(t){t&&e(this.$refs.search).focus()}},props:["postType","context","contextId","show","callbacks","exclude"],created(){},mounted(){this.term="",this.paged=1,this.search()},methods:{doSearch(e){this.term=e.target.value,this.paged=1,this.search()},search:_.debounce((function(s){e("#modal-search-items").addClass("loading");const a=this;t.post(window.location.href,{type:this.postType,context:this.context,context_id:this.contextId,term:s||this.term,paged:this.paged,exclude:this.exclude,"lp-ajax":"modal_search_items",nonce:lpGlobalSettings.nonce},{emulateJSON:!0,params:{}}).then((function(t){const s=LP.parseJSON(t.body||t.bodyText);a.hasItems=!!_.size(s.items),e("#modal-search-items").removeClass("loading"),e(a.$el).find(".search-results").html(s.html).find('input[type="checkbox"]').each((function(){const t=parseInt(e(this).val());_.indexOf(a.selected,t)>=0&&(this.checked=!0)})),_.debounce((function(){e(a.$el).find(".search-nav").html(s.nav).find("a, span").addClass("button").filter("span").addClass("disabled")}),10)()}))}),500),loadPage(t){t.preventDefault();const s=e(t.target);if(!s.is("span")){if(s.hasClass("next"))this.paged++;else if(s.hasClass("prev"))this.paged--;else{const e=s.html();this.paged=parseInt(e)}this.search()}},selectItem(t){const s=e(t.target).closest("li").find('input[type="checkbox"]'),a=parseInt(s.val()),c=_.indexOf(this.selected,a);s.is(":checked")?-1===c&&this.selected.push(a):c>=0&&this.selected.splice(c,1)},addItems(){this.callbacks&&this.callbacks.addItems&&this.callbacks.addItems.call(this),e(document).triggerHandler("learn-press/add-order-items",this.selected)},close(){this.$emit("close")}}}),window.LP.$modalSearchItems=new $Vue({el:"#vue-modal-search-items",data:{show:!1,term:"",postType:"",callbacks:{},exclude:"",context:""},methods:{open(e){_.each(e.data,(function(e,t){this[t]=e}),this),this.callbacks=e.callbacks,this.focusSearch()},close(){this.show=!1},focusSearch:_.debounce((function(){e('input[name="search"]',this.$el).focus()}),200)}}))}));