!function(e){e((function(){const t=window._;window.$Vue=window.$Vue||window.Vue;const s=!!$Vue&&$Vue.http;document.getElementById("vue-modal-search-users")&&$Vue&&($Vue.component("learn-press-modal-search-users",{template:"#learn-press-modal-search-users",data:function(){return{paged:1,term:"",hasUsers:!1,selected:[]}},watch:{show:function(t){t&&e(this.$refs.search).focus()}},props:["multiple","context","contextId","show","callbacks","textFormat","exclude"],created:function(){},methods:{doSearch:function(e){this.term=e.target.value,this.paged=1,this.search()},search:t.debounce((function(a){const c=this;s.post(window.location.href,{type:this.postType,context:this.context,context_id:this.contextId,term:a||this.term,paged:this.paged,multiple:this.multiple?"yes":"no",text_format:this.textFormat,exclude:this.exclude,"lp-ajax":"modal_search_users"},{emulateJSON:!0,params:{}}).then((function(s){const a=LP.parseJSON(s.body||s.bodyText);c.hasUsers=!!t.size(a.users),e(c.$el).find(".search-results").html(a.html).find('input[type="checkbox"]').each((function(){const s=parseInt(e(this).val());t.indexOf(c.selected,s)>=0&&(this.checked=!0)})),t.debounce((function(){e(c.$el).find(".search-nav").html(a.nav).find("a, span").addClass("button").filter("span").addClass("disabled")}),10)()}))}),500),loadPage:function(t){t.preventDefault();const s=e(t.target);if(!s.is("span")){if(s.hasClass("next"))this.paged++;else if(s.hasClass("prev"))this.paged--;else{const e=s.html();this.paged=parseInt(e)}this.search()}},selectItem:function(s){const a=e(s.target).closest("li"),c=a.find('input[type="checkbox"]'),n=parseInt(c.val()),i=t.findLastIndex(this.selected,{id:n});this.multiple?c.is(":checked")?-1===i&&this.selected.push(a.closest("li").data("data")):i>=0&&this.selected.splice(i,1):(s.preventDefault(),this.selected=[a.closest("li").data("data")],this.addUsers())},addUsers:function(){e(this.$el).find(".lp-result-item"),this.callbacks&&this.callbacks.addUsers&&this.callbacks.addUsers.call(this,this.selected),e(document).triggerHandler("learn-press/modal-add-users",this.selected)},close:function(){this.$emit("close")}}}),window.LP.$modalSearchUsers=new $Vue({el:"#vue-modal-search-users",data:{show:!1,term:"",multiple:!1,callbacks:{},textFormat:"{{display_name}} ({{email}})",exclude:0},methods:{open:function(e){t.each(e.data,(function(e,t){this[t]=e}),this),this.callbacks=e.callbacks,this.focusSearch()},close:function(){this.show=!1},focusSearch:t.debounce((function(){e('input[name="search"]',this.$el).focus()}),200)}}))}))}(jQuery);