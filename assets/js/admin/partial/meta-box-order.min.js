!function(e){"use strict";window.$Vue=window.$Vue||Vue,jQuery((function(){var t=e(".list-order-items").find("tbody"),o=e("#list-users"),r=function(e,t){return _.template(e,{evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g})(t)},s={template:"#tmpl-order-advanced-list-item",onRemove(){0===this.$el.children().length&&this.$el.append('<li class="user-guest">'+d.i18n_guest+"</li>"),console.log(this.$el)},onAdd(){this.$el.find(".user-guest").remove()}},d=lpMetaBoxOrderSettings;o.length&&(o.LP("AdvancedList",s),d.users&&_.forEach(d.users,(function(e,t){o.LP("AdvancedList","add",[r(d.userTextFormat,e),t])}))),t.on("click",".remove-order-item",(function(o){o.preventDefault();const r=e(this).closest("tr"),s=r.data("item_id");r.remove(),0===t.children(":not(.no-order-items)").length&&t.find(".no-order-items").show(),$Vue.http.post(window.location.href,{order_id:e("#post_ID").val(),items:[s],"lp-ajax":"remove_items_from_order",remove_nonce:e(this).closest(".order-item-row").data("remove_nonce")},{emulateJSON:!0,params:{}}).then((function(t){const o=LP.parseJSON(t.body||t.bodyText);e(".order-subtotal").html(o.order_data.subtotal_html),e(".order-total").html(o.order_data.total_html)}))})),e(".order-date.date-picker-backendorder").on("change",(function(){const t=this.value.split("-");["aa","mm","jj"].forEach((function(o,r){e('input[name="'+o+'"]').val(t[r])}))})).datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,select(){console.log(arguments)}}),e("#learn-press-add-order-item").on("click",(function(){LP.$modalSearchItems.open({data:{postType:"lp_course",context:"order-items",contextId:e("#post_ID").val(),exclude:e(".list-order-items tbody").children(".order-item-row").map((function(){return e(this).data("id")})).get(),show:!0},callbacks:{addItems(){$Vue.http.post(window.location.href,{order_id:this.contextId,items:this.selected,"lp-ajax":"add_items_to_order",nonce:lpGlobalSettings.nonce},{emulateJSON:!0,params:{}}).then((function(o){const r=LP.parseJSON(o.body||o.bodyText),s=t.find(".no-order-items").hide();e(r.item_html).insertBefore(s),e(".order-subtotal").html(r.order_data.subtotal_html),e(".order-total").html(r.order_data.total_html)})),this.close()}}})})),e(document).on("click",".change-user",(function(t){t.preventDefault(),LP.$modalSearchUsers.open({data:{context:"order-items",contextId:e("#post_ID").val(),show:!0,multiple:"yes"===e(this).data("multiple"),exclude:e("#list-users").children().map((function(){return e(this).data("id")})).get(),textFormat:d.userTextFormat},callbacks:{addUsers(t){if(this.multiple){o.length||((o=e(LP.template("tmpl-order-data-user")({multiple:!0}))).LP("AdvancedList",s),e(".order-data-user").replaceWith(o));for(let e=0;e<this.selected.length;e++)o.LP("AdvancedList","add",[r(this.textFormat,this.selected[e]),this.selected[e].id])}else{const t=LP.template("tmpl-order-data-user")({name:r(this.textFormat,this.selected[0]),id:this.selected[0].id});e(".order-data-user").replaceWith(t)}this.close()}}})}))}))}(jQuery);